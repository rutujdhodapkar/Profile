<!-- Dotted lines background -->

<iframe src="animations/dotted lines.html" style="width:100vw; height:100vh; border:none; position:fixed; top:0; left:0; z-index:-1; pointer-events:none;"></iframe>

<script>
  // Redirect to detail.html if screen width is greater than 930px
  (function() {
    function redirectIfWide() {
      if (window.innerWidth > 930) {
        window.location.href = "detail.html";
      }
    }
    // Run on load
    redirectIfWide();
    // Optionally, also redirect if user resizes window to be wider
    window.addEventListener('resize', redirectIfWide);
  })();
</script>

<style>
  html, body {
    height: 100%;
    margin: 0;
    padding: 0;
    box-sizing: border-box;
  }
  body {
    min-height: 100vh;
    min-width: 100vw;
    box-sizing: border-box;
    margin: 0;
    padding: 0;
  }
  .outer-padding-8px {
    box-sizing: border-box;
    padding: 8px;
    width: 100vw;
    min-height: 100vh;
    height: 100%;
    display: flex;
    flex-direction: column;
    align-items: stretch;
    justify-content: flex-start;
  }
  .frame-stack-container {
    position: relative;
    width: 100%;
    min-height: 100%;
    box-sizing: border-box;
    padding: 0;
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    gap: 16px;
    z-index: 1;
    height: 100vh;
    scroll-behavior: smooth;
  }
  .frame-box {
    width: 100%;
    max-width: 600px;
    min-height: calc(100vh - 10vw - 16px);
    background: rgba(255,255,255,0.10);
    border-radius: 2.2rem;
    box-shadow: 0 8px 32px 0 rgba(31,38,135,0.18);
    border: 2.5px solid rgba(224,224,224,0.18);
    margin: 0 auto;
    display: flex;
    flex-direction: column;
    justify-content: center;
    align-items: center;
    position: absolute;
    left: 50%;
    top: 50%;
    right: auto;
    bottom: auto;
    transform: translate(-50%, -50%);
    transition: opacity 0.35s, transform 0.35s;
    opacity: 0;
    pointer-events: auto;
    z-index: 2;
    backdrop-filter: blur(18px) saturate(180%);
    -webkit-backdrop-filter: blur(18px) saturate(180%);
    overflow: visible;
  }
  .frame-box.active {
    opacity: 1;
    pointer-events: auto;
    z-index: 10;
  }
  .frame-box.above {
    opacity: 0;
    pointer-events: none;
    z-index: 1;
    transform: translate(-50%, calc(-50% - 40px)) scale(0.98);
  }
  .frame-box.below {
    opacity: 0;
    pointer-events: none;
    z-index: 1;
    transform: translate(-50%, calc(-50% + 40px)) scale(0.98);
  }
  .frame-box iframe {
    width: 100%;
    height: 100%;
    min-height: 100%;
    border: none;
    border-radius: 0;
    background: transparent;
    display: block;
  }
  /* Transparent overlay for the whole page */
  .page-overlay {
    position: fixed;
    left: 50%;
    top: 50%;
    transform: translate(-50%, -50%);
    width: 100vw;
    height: 100vh;
    z-index: 1000;
    pointer-events: auto;
    background: rgba(255,255,255,0.04);
    border-radius: 0; /* Will be clipped to frame shape using clip-path */
    overflow: hidden;
    /* Prevent scroll on overlay */
    touch-action: none;
    /* For smooth click-through, but not scroll */
    transition: opacity 0.2s;
    opacity: 1;
  }
  .page-overlay.inactive {
    pointer-events: none !important;
    opacity: 0 !important;
  }
  /* Notification box for overlay click */
  .overlay-notification {
    position: fixed;
    top: 24px;
    left: 50%;
    transform: translateX(-50%);
    background: #fff;
    color: #222;
    border-radius: 1.2rem;
    box-shadow: 0 4px 24px 0 rgba(31,38,135,0.10);
    padding: 0.85em 2em;
    font-size: 1.08em;
    font-weight: 500;
    z-index: 2000;
    opacity: 0;
    pointer-events: none;
    transition: opacity 0.3s;
    min-width: 220px;
    text-align: center;
    letter-spacing: 0.01em;
    border: 1.5px solid #eee;
  }
  .overlay-notification.active {
    opacity: 1;
    pointer-events: auto;
  }
  /* Use clip-path to match the frame's border-radius and size */
  @media (min-width: 701px) {
    .page-overlay {
      max-width: 600px;
      min-height: calc(100vh - 10vw - 16px);
      width: 100vw;
      height: calc(100vh - 10vw - 16px);
      border-radius: 2.2rem;
      clip-path: inset(0 round 2.2rem);
    }
    .overlay-notification {
      border-radius: 1.2rem;
      max-width: 420px;
    }
  }
  @media (max-width: 700px) {
    .page-overlay {
      width: 100vw;
      height: calc(100vh - 8vw - 16px);
      border-radius: 1.5rem;
      max-width: 100vw;
      min-height: calc(100vh - 8vw - 16px);
      clip-path: inset(0 round 1.5rem);
    }
    .frame-corner {
      width: 22px;
      height: 22px;
    }
    .overlay-notification {
      border-radius: 0.9rem;
      max-width: 95vw;
      font-size: 1em;
      padding: 0.7em 1.2em;
    }
  }
  /* Frame corners for overlay */
  .frame-corner {
    position: absolute;
    width: 32px;
    height: 32px;
    z-index: 1001;
    pointer-events: none;
  }
  .frame-corner.tl { top: 0; left: 0; }
  .frame-corner.tr { top: 0; right: 0; }
  .frame-corner.bl { bottom: 0; left: 0; }
  .frame-corner.br { bottom: 0; right: 0; }
  .frame-corner svg {
    width: 100%;
    height: 100%;
    display: block;
  }
  .frame-nav-dots {
    position: fixed;
    left: 24px;
    top: 50%;
    transform: translateY(-50%);
    right: auto;
    bottom: auto;
    display: flex;
    flex-direction: column;
    align-items: flex-start;
    justify-content: center;
    gap: 12px;
    z-index: 100;
    pointer-events: none;
  }
  .frame-nav-dot {
    width: 10px;
    height: 10px;
    border-radius: 50%;
    background: #fff6;
    border: 2px solid #fff;
    opacity: 0.7;
    transition: background 0.2s, opacity 0.2s;
    pointer-events: auto;
    cursor: pointer;
  }
  .frame-nav-dot.active {
    background: #fff;
    opacity: 1;
  }
</style>

<script>
  // Frame-by-frame scroll logic
  document.addEventListener('DOMContentLoaded', function() {
    // Frame navigation logic
    const frames = Array.from(document.querySelectorAll('.frame-box'));
    let currentFrame = 0;

    function showFrame(idx, direction = 0) {
      frames.forEach((frame, i) => {
        frame.classList.remove('active', 'above', 'below');
        if (i === idx) {
          frame.classList.add('active');
        } else if (i < idx) {
          frame.classList.add('above');
        } else {
          frame.classList.add('below');
        }
      });
      // Update nav dots
      document.querySelectorAll('.frame-nav-dot').forEach((dot, i) => {
        dot.classList.toggle('active', i === idx);
      });
    }

    // Create navigation dots
    let navDots = document.createElement('div');
    navDots.className = 'frame-nav-dots';
    frames.forEach((frame, i) => {
      let dot = document.createElement('div');
      dot.className = 'frame-nav-dot' + (i === 0 ? ' active' : '');
      dot.addEventListener('click', function(e) {
        e.preventDefault();
        currentFrame = i;
        showFrame(currentFrame);
      });
      navDots.appendChild(dot);
    });
    document.body.appendChild(navDots);

    // Initial show
    showFrame(currentFrame);

    // Scroll event handler (wheel/touch)
    let scrollLock = false;
    let lastTouchY = null;

    function nextFrame() {
      if (currentFrame < frames.length - 1) {
        currentFrame++;
        showFrame(currentFrame, 1);
      } else if (currentFrame === frames.length - 1) {
        window.location.href = "contact.html";
      }
    }
    function prevFrame() {
      if (currentFrame > 0) {
        currentFrame--;
        showFrame(currentFrame, -1);
      }
    }

    // Mouse wheel
    window.addEventListener('wheel', function(e) {
      if (scrollLock) return;
      if (Math.abs(e.deltaY) < 20) return;
      if (e.deltaY < 0 && currentFrame === 0) {
        window.location.href = "mobile.html";
        e.preventDefault();
        return;
      }
      if (e.deltaY > 0 && currentFrame === frames.length - 1) {
        window.location.href = "contact.html";
        e.preventDefault();
        return;
      }
      scrollLock = true;
      if (e.deltaY > 0) {
        nextFrame();
      } else if (e.deltaY < 0) {
        prevFrame();
      }
      setTimeout(() => { scrollLock = false; }, 500);
      e.preventDefault();
    }, { passive: false });

    // Touch swipe
    window.addEventListener('touchstart', function(e) {
      if (e.touches.length === 1) {
        lastTouchY = e.touches[0].clientY;
      }
    }, { passive: false });
    window.addEventListener('touchmove', function(e) {
      if (lastTouchY === null) return;
      let deltaY = e.touches[0].clientY - lastTouchY;
      if (deltaY > 60 && !scrollLock && currentFrame === 0) {
        window.location.href = "mobile.html";
        lastTouchY = null;
        e.preventDefault();
        return;
      }
      if (deltaY < -60 && !scrollLock && currentFrame === frames.length - 1) {
        window.location.href = "contact.html";
        lastTouchY = null;
        e.preventDefault();
        return;
      }
      if (Math.abs(deltaY) > 60 && !scrollLock) {
        scrollLock = true;
        if (deltaY < 0) {
          nextFrame();
        } else {
          prevFrame();
        }
        setTimeout(() => { scrollLock = false; }, 500);
        lastTouchY = null;
      }
    }, { passive: false });
    window.addEventListener('touchend', function(e) {
      lastTouchY = null;
    });

    // Keyboard navigation (optional)
    window.addEventListener('keydown', function(e) {
      if (e.key === 'ArrowDown' || e.key === 'PageDown') {
        if (currentFrame === frames.length - 1) {
          window.location.href = "contact.html";
          e.preventDefault();
          return;
        }
        nextFrame();
        e.preventDefault();
      } else if (e.key === 'ArrowUp' || e.key === 'PageUp') {
        if (currentFrame === 0) {
          window.location.href = "mobile.html";
          e.preventDefault();
          return;
        }
        prevFrame();
        e.preventDefault();
      }
    });

    // Overlay click: disappear for 2s, show notification for 3s, then restore
    // Notification box creation
    let notification = document.createElement('div');
    notification.className = 'overlay-notification';
    notification.textContent = "click again to execute ";
    document.body.appendChild(notification);

    let notificationTimeout = null;
    let overlayTimeout = null;

    const overlay = document.querySelector('.page-overlay');
    if (overlay) {
      overlay.addEventListener('click', function(e) {
        // Show notification for 3 seconds
        notification.classList.add('active');
        clearTimeout(notificationTimeout);
        notificationTimeout = setTimeout(function() {
          notification.classList.remove('active');
        }, 3000);

        // Get the click coordinates
        const x = e.clientX;
        const y = e.clientY;

        // Hide overlay (make it pointer-events:none and transparent)
        overlay.classList.add('inactive');

        // Find the element under the overlay at the click position
        // Use setTimeout to ensure overlay is not blocking
        setTimeout(function() {
          // Get the element at the click position
          const el = document.elementFromPoint(x, y);
          if (el && el !== overlay) {
            // Create a new MouseEvent and dispatch it to the underlying element
            const evt = new MouseEvent('click', {
              bubbles: true,
              cancelable: true,
              view: window,
              clientX: x,
              clientY: y
            });
            el.dispatchEvent(evt);
          }
        }, 0);

        // Restore overlay after 2s (2000ms)
        clearTimeout(overlayTimeout);
        overlayTimeout = setTimeout(function() {
          overlay.classList.remove('inactive');
        }, 2000);

        // Prevent scroll/touch on overlay (still)
        // (No e.preventDefault() here, so click can go through)
      });

      // Prevent scroll/touch on overlay
      overlay.addEventListener('wheel', function(e) { e.preventDefault(); }, { passive: false });
      overlay.addEventListener('touchmove', function(e) { e.preventDefault(); }, { passive: false });
    }
  });
</script>

<div class="outer-padding-8px">
  <div class="frame-stack-container" style="height:100vh; position:relative; justify-content:center; align-items:center;">
    <!-- Frame 1: info.html -->
    <div class="frame-box active" style="height:calc(100vh - 10vw - 16px); display:flex; flex-direction:column; justify-content:center; align-items:center;">
      <iframe src="info mobile.html" title="Info" tabindex="-1"></iframe>
    </div>
    <!-- Frame 2: skill mobile.html and skill section mobile.html (stacked vertically, NO line between) -->
    <div class="frame-box" style="height:calc(100vh - 10vw - 16px); display:flex; flex-direction:column; gap:0; padding:0; justify-content:center; align-items:center;">
      <iframe src="skill mobile.html" title="Skill Squares" style="flex:1 1 50%; min-height:48%;" tabindex="-1"></iframe>
      <iframe src="skill section mobile.html" title="Skill Circles" style="flex:1 1 50%; min-height:48%;" tabindex="-1"></iframe>
    </div>
    <!-- Frame 3: certificat.html -->
    <div class="frame-box" style="height:calc(100vh - 10vw - 16px); display:flex; flex-direction:column; justify-content:center; align-items:center;">
      <iframe src="certificate mobile.html" title="Certificates" tabindex="-1"></iframe>
    </div>
    <!-- Frame 4: project mobile.html -->
    <div class="frame-box" style="height:calc(100vh - 10vw - 16px); display:flex; flex-direction:column; justify-content:center; align-items:center;">
      <iframe src="project mobile.html" title="Projects" tabindex="-1"></iframe>
    </div>
  </div>
  <!-- Transparent overlay and corners for the whole page, matching the frame shape -->
  <div class="page-overlay">
    <div class="frame-corner tl">
      <svg viewBox="0 0 32 32"><polyline points="32,0 0,0 0,32" fill="none" stroke="#fff" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round" opacity="0.7"/></svg>
    </div>
    <div class="frame-corner tr">
      <svg viewBox="0 0 32 32"><polyline points="0,0 32,0 32,32" fill="none" stroke="#fff" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round" opacity="0.7"/></svg>
    </div>
    <div class="frame-corner bl">
      <svg viewBox="0 0 32 32"><polyline points="0,0 0,32 32,32" fill="none" stroke="#fff" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round" opacity="0.7"/></svg>
    </div>
    <div class="frame-corner br">
      <svg viewBox="0 0 32 32"><polyline points="32,0 32,32 0,32" fill="none" stroke="#fff" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round" opacity="0.7"/></svg>
    </div>
  </div>
</div>
