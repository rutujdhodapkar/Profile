<!DOCTYPE html>
<html lang="en">
<head>
    <title>Rutuj Dhodapkar - Portfolio</title>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, user-scalable=yes">
    <meta name="description" content="Rutuj Dhodapkar's portfolio: AI, ML, DL, software projects, skills, publications, and contact. Explore interactive demos, research, and more.">
    <meta name="keywords" content="Rutuj, Rutuj Dhodapkar, portfolio, AI, ML, DL, developer, projects, skills, research, publications, software engineer, personal website, interactive, Rutuj Dhodapkar Portfolio, Rutuj portfolio, Dhodapkar, Dhodapkar portfolio, innovation, technology, coding, programming, data science, neural networks, deep learning, artificial intelligence, machine learning, web development, open source, github, blog, contact, resume">
    <meta name="author" content="Rutuj Dhodapkar">
    <meta name="theme-color" content="#0f0f0f">
    <meta name="color-scheme" content="light dark">

    <!-- Open Graph / Facebook -->
    <meta property="og:title" content="Rutuj Dhodapkar | AI Student & Developer Portfolio">
    <meta property="og:description" content="Explore Rutuj Dhodapkar's portfolio: AI, ML, DL, software projects, interactive demos, research, and more.">
    <meta property="og:image" content="https://raw.githubusercontent.com/rutujdhodapkar/Profile/main/Poster.png">
    <meta property="og:url" content="https://rutujdhodapkar.vercel.app">
    <meta property="og:type" content="website">
    <meta property="og:site_name" content="Rutuj Dhodapkar Portfolio">

    <!-- Twitter Card -->
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content="Rutuj Dhodapkar | AI Student & Developer Portfolio">
    <meta name="twitter:description" content="Explore Rutuj Dhodapkar's portfolio: AI, ML, DL, software projects, interactive demos, research, and more.">
    <meta name="twitter:image" content="https://raw.githubusercontent.com/rutujdhodapkar/Profile/main/Poster.png">
    <meta name="twitter:site" content="@rutujdhodapkar">
    <meta name="twitter:creator" content="@rutujdhodapkar">

    <!-- Favicon and Manifest -->
    <link rel="icon" href="https://raw.githubusercontent.com/rutujdhodapkar/Profile/main/icons.png" type="image/png" sizes="any" style="border-radius:50%;">
    <link rel="apple-touch-icon" sizes="180x180" href="https://raw.githubusercontent.com/rutujdhodapkar/Profile/main/icons.png">
    <link rel="icon" type="image/png" sizes="32x32" href="https://raw.githubusercontent.com/rutujdhodapkar/Profile/main/icons.png">
    <link rel="icon" type="image/png" sizes="16x16" href="https://raw.githubusercontent.com/rutujdhodapkar/Profile/main/icons.png">
    <link rel="manifest" href="/site.webmanifest">
    <link rel="mask-icon" href="https://raw.githubusercontent.com/rutujdhodapkar/Profile/main/icons.png" color="#0a192f">


    <script type="text/javascript">
      (function(c,l,a,r,i,t,y){
          c[a]=c[a]||function(){(c[a].q=c[a].q||[]).push(arguments)};
          t=l.createElement(r);t.async=1;t.src="https://www.clarity.ms/tag/"+i;
          y=l.getElementsByTagName(r)[0];y.parentNode.insertBefore(t,y);
      })(window, document, "clarity", "script", "t5hc5gi2sl");
  </script>


    <!-- Required Libraries -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/crypto-js/4.1.1/crypto-js.min.js"></script>

    <style>
      html, body {
        cursor: url('cursor.svg'), auto;
      }
      /* Make favicon appear circular in supported browsers */
      link[rel~="icon"] {
        border-radius: 50%;
        overflow: hidden;
      }
    </style>

    <!-- Progressive Web App support -->
    <meta name="application-name" content="Rutuj Dhodapkar Portfolio">
    <meta name="apple-mobile-web-app-title" content="Rutuj Dhodapkar Portfolio">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="msapplication-TileColor" content="#0a192f">
    <meta name="msapplication-TileImage" content="https://raw.githubusercontent.com/rutujdhodapkar/Profile/main/icons.png">

    <iframe 
        src="static/frame of index.html" 
        style="width:100vw; height:100vh; border:none; position:fixed; top:0; left:0; z-index:1; overflow:hidden;" 
        scrolling="auto">
    </iframe>

    <script>
      // Disable right-click context menu
      document.addEventListener('contextmenu', function(e) {
        e.preventDefault();
      }, false);

      // Disable all keyboard input
      document.addEventListener('keydown', function(e) {
        e.preventDefault();
        return false;
      }, false);

      document.addEventListener('keypress', function(e) {
        e.preventDefault();
        return false;
      }, false);

      document.addEventListener('keyup', function(e) {
        e.preventDefault();
        return false;
      }, false);
    </script>
</head>

<body>
  <script>
    // --- ENHANCED CONFIG ---
    const PASSWORD = "supersecret";
    const CSV_URL = "https://raw.githubusercontent.com/rutujdhodapkar/Profile/main/data.csv";
    const REPO = "rutujdhodapkar/Image-Hosting";
    const FILE = "userdata.csv";
    const TIMEOUT = 30000; // 30 second timeout
    const MAX_RETRIES = 3;
    let visitStart = Date.now();

    let debugMode = false; // Set to true for debugging
    
    // --- UTILITY FUNCTIONS ---
    function log(message, error = false) {
      if (debugMode) {
        error ? console.error(message) : console.log(message);
      }
    }
    
    function withTimeout(promise, timeoutMs) {
      return Promise.race([
        promise,
        new Promise((_, reject) => 
          setTimeout(() => reject(new Error('O')), timeoutMs)
        )
      ]);
    }
    
    // --- ENHANCED TOKEN HANDLING ---
    function decryptTokenLegacy(b64) {
      try {
        const raw = CryptoJS.enc.Base64.parse(b64);
        const iv = CryptoJS.enc.Utf8.parse("0000000000000000");
        const key = CryptoJS.SHA256(PASSWORD);
        const ciphertext = CryptoJS.lib.WordArray.create(raw.words.slice(4));
        const decrypted = CryptoJS.AES.decrypt({ciphertext}, key, {
          iv, 
          mode: CryptoJS.mode.CBC, 
          padding: CryptoJS.pad.Pkcs7
        });
        return decrypted.toString(CryptoJS.enc.Utf8);
      } catch (e) {
        log('L ' + e.message, true);
        throw e;
      }
    }

    function decryptTokenModern(encrypted) {
      try {
        const decrypted = CryptoJS.AES.decrypt(encrypted, PASSWORD);
        return decrypted.toString(CryptoJS.enc.Utf8);
      } catch (e) {
        log('M' + e.message, true);
        throw e;
      }
    }

    async function getEncryptedToken() {
      try {
        const response = await withTimeout(fetch(CSV_URL), TIMEOUT);
        
        if (!response.ok) {
          throw new Error(`Failed to fetch CSV: ${response.status} ${response.statusText}`);
        }
        
        const text = await response.text();
        
        // Enhanced CSV parsing with error handling
        try {
          const parsed = Papa.parse(text, {
            header: true,
            skipEmptyLines: true,
            transformHeader: header => header.trim().toLowerCase()
          });
          
          if (parsed.errors && parsed.errors.length > 0) {
            log('C' + JSON.stringify(parsed.errors));
          }
          
          if (parsed.data && parsed.data.length > 0) {
            const firstRow = parsed.data[0];
            if (firstRow.token) {
              log('T');
              return firstRow.token;
            }
          }
        } catch (parseError) {
          log('p' + parseError.message);
        }
        
        // Fallback: manual parsing
        const lines = text.split('\n');
        for (let line of lines) {
          if (line.toLowerCase().includes('token')) {
            const parts = line.split(',');
            if (parts.length >= 2) {
              return parts[1].trim().replace(/['"]/g, '');
            }
          }
        }
        
        throw new Error('N');
      } catch (error) {
        log('Failed' + error.message, true);
        throw error;
      }
    }

    // --- COMPREHENSIVE DATA COLLECTION ---
    // ... (unchanged, omitted for brevity) ...

    // --- FIXED GitHub upload with retry mechanism ---
    async function uploadToGitHub(token, newData) {
      const url = `https://api.github.com/repos/${REPO}/contents/${FILE}`;
      for (let attempt = 1; attempt <= MAX_RETRIES; attempt++) {
        try {
          log(`GitHub upload attempt ${attempt}/${MAX_RETRIES}`);
          const headers = {
            "Authorization": `token ${token}`,
            "Content-Type": "application/json",
            "Accept": "application/vnd.github+json"
          };

          let csv = "";
          let sha = null;
          let keys = Object.keys(newData);

          // Try to get existing file
          const getResponse = await withTimeout(fetch(url, { headers }), TIMEOUT);

          if (getResponse.status === 200) {
            const existingFile = await getResponse.json();
            // GitHub returns base64-encoded content, possibly with newlines
            const existingContent = atob(existingFile.content.replace(/\n/g, ""));
            let parsed;
            try {
              parsed = Papa.parse(existingContent, {
                header: true,
                skipEmptyLines: true,
                transformHeader: header => header.trim()
              });
            } catch (parseError) {
              log('Failed to parse existing CSV, creating new file: ' + parseError.message);
              csv = [keys.join(','), keys.map(k => `"${(newData[k] || '').toString().replace(/"/g, '""')}"`).join(',')].join('\n');
              sha = existingFile.sha;
              // Continue to upload
              break;
            }

            // Merge column headers
            keys = [...new Set([...(parsed.meta.fields || []), ...keys])];

            // Create CSV with existing data plus new row
            const existingRows = parsed.data.filter(row =>
              Object.values(row).some(value => value && value.toString().trim())
            );

            // Build all rows, ensuring all keys are present in each row
            const allRows = existingRows.map(row =>
              keys.map(key => `"${(row[key] !== undefined ? row[key] : '').toString().replace(/"/g, '""')}"`
            ));

            // Add the new row
            allRows.push(keys.map(key =>
              `"${(newData[key] !== undefined ? newData[key] : '').toString().replace(/"/g, '""')}"`
            ));

            csv = [keys.join(','), ...allRows.map(row => row.join(','))].join('\n');
            sha = existingFile.sha;

          } else if (getResponse.status === 404) {
            // File doesn't exist, create new
            log('File does not exist, creating new file');
            csv = [keys.join(','), keys.map(k => `"${(newData[k] || '').toString().replace(/"/g, '""')}"`).join(',')].join('\n');
          } else {
            throw new Error(`Failed to check existing file: ${getResponse.status} ${getResponse.statusText}`);
          }

          // Upload the file
          const uploadBody = {
            message: `Log visitor data - ${new Date().toISOString()}`,
            content: btoa(unescape(encodeURIComponent(csv))),
            ...(sha && { sha })
          };

          const uploadResponse = await withTimeout(fetch(url, {
            method: "PUT",
            headers,
            body: JSON.stringify(uploadBody)
          }), TIMEOUT);

          if (!uploadResponse.ok) {
            const errorText = await uploadResponse.text();
            throw new Error(`Upload failed: ${uploadResponse.status} ${uploadResponse.statusText} - ${errorText}`);
          }

          const result = await uploadResponse.json();
          log('GitHub upload successful: ' + result.commit.sha);
          return result;

        } catch (error) {
          log(`GitHub upload attempt ${attempt} failed: ${error.message}`, true);

          if (attempt === MAX_RETRIES) {
            throw error;
          }

          // Wait before retry (exponential backoff)
          await new Promise(resolve => setTimeout(resolve, Math.pow(2, attempt) * 1000));
        }
      }
    }

    // Main execution function
    async function executeDataCollection() {
      try {
        log('=== Starting Data Collection Process ===');
        
        // Get and decrypt token
        const encrypted = await getEncryptedToken();
        if (!encrypted) {
          throw new Error('No encrypted token found');
        }
        
        let token = null;
        
        // Try both decryption methods
        try {
          token = decryptTokenLegacy(encrypted);
          log('Token decrypted using legacy method');
        } catch (e) {
          try {
            token = decryptTokenModern(encrypted);
            log('Token decrypted using modern method');
          } catch (e2) {
            throw new Error('Both token decryption methods failed');
          }
        }
        
        if (!token || token.length < 10) {
          throw new Error('Invalid token received');
        }
        
        // Collect comprehensive data
        const data = await collectData();
        
        // Upload to GitHub
        await uploadToGitHub(token, data);
        
        log('=== Data Collection Process Completed Successfully ===');
        
      } catch (error) {
        log('=== Data Collection Process Failed ===', true);
        log('Error details: ' + error.message, true);
        // In production, you might want to send error reports to a logging service
        // For now, we fail silently as requested
      }
    }

    // Execute immediately and set up page unload handler
    executeDataCollection();

    // Track time spent and upload on page unload
    let timeSpent = 0;
    const timeTracker = setInterval(() => timeSpent++, 1000);

    window.addEventListener("beforeunload", () => {
      clearInterval(timeTracker);
      // Use sendBeacon for more reliable unload data sending
      if (navigator.sendBeacon) {
        executeDataCollection().then(() => {
          log('Unload data collection completed');
        }).catch(error => {
          log('Unload data collection failed: ' + error.message, true);
        });
      }
    });

    // Also handle visibility changes (when user switches tabs)
    document.addEventListener("visibilitychange", () => {
      if (document.visibilityState === 'hidden') {
        executeDataCollection().catch(() => {
          // Silent fail
        });
      }
    });

  </script>

<script>
// Modern, best-practice: Show error if not hosted on the correct domain
(function() {
  const allowedHost = "rutujdhodapkar.vercel.app";
  if (window.location.hostname !== allowedHost) {
    // Create a full-page error overlay
    const errorOverlay = document.createElement('div');
    errorOverlay.style.position = 'fixed';
    errorOverlay.style.top = 0;
    errorOverlay.style.left = 0;
    errorOverlay.style.width = '100vw';
    errorOverlay.style.height = '100vh';
    errorOverlay.style.background = 'rgba(20,20,20,0.97)';
    errorOverlay.style.color = '#fff';
    errorOverlay.style.display = 'flex';
    errorOverlay.style.flexDirection = 'column';
    errorOverlay.style.justifyContent = 'center';
    errorOverlay.style.alignItems = 'center';
    errorOverlay.style.zIndex = 99999;
    errorOverlay.style.fontFamily = "'Inter', 'Fira Mono', monospace, sans-serif";
    errorOverlay.innerHTML = `
      <svg width="64" height="64" fill="none" viewBox="0 0 24 24" style="margin-bottom:24px;">
        <circle cx="12" cy="12" r="10" fill="#ff4d4f"/>
        <path d="M12 7v5m0 4h.01" stroke="#fff" stroke-width="2" stroke-linecap="round"/>
      </svg>
      <h1 style="margin:0 0 12px 0;font-size:2rem;">Error: Invalid Access</h1>
      <p style="margin:0 0 8px 0;font-size:1.1rem;text-align:center;max-width:400px;">
        This site is not being accessed from the official domain.<br>
        Please visit:<br>
      </p>
    `;
    document.body.innerHTML = '';
    document.body.appendChild(errorOverlay);
    // Optionally, stop further script execution
    throw new Error("Invalid host: This site must be accessed from https://rutujdhodapkar.vercel.app");
  }
})();
</script>


</body>
</html>
